Transactional messaging systems like Kafka can be used to provide stronger guarantees so long as all event consumers have the transactions feature enabled. 
  
+++++
<pre class="snippet"><code class="java">{% include_raw tutorials/esp/kafka/code/tutorial-steps/dev/03a-esp.sh %}</code></pre>
+++++
